# Configuration for module registration tests
# This extends the base test configuration
micronaut:
  test:
    resources:
      enabled: true

# Disable bootstrapper for these tests
app:
  engine:
    bootstrapper:
      enabled: false
  config:
    cluster-name: registration-test-cluster
    consul:
      key-prefixes:
        pipeline-clusters: pipeline-configs/clusters
        schema-versions: pipeline-configs/schemas/versions
      watch-seconds: 5

consul:
  client:
    enabled: true
    registration:
      enabled: false # Don't register the engine itself
    discovery:
      enabled: true
      shared-instance: true

# Enable Consul test container
testcontainers:
  consul:
    enabled: true

# Kafka configuration for tests
kafka:
  enabled: true
  schema:
    registry:
      type: apicurio
  producers:
    default:
      apicurio:
        registry:
          url: ${apicurio.registry.url}

# gRPC configuration
grpc:
  server:
    port: 0  # Use 0 for random available port
    enable-reflection: true

# Logging
logger:
  levels:
    com.krickert.search.pipeline.step.registration: DEBUG