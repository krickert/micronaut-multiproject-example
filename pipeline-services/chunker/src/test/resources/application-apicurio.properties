# ========== APICURIO ENVIRONMENT CONFIGURATION ==========
# Configuration for the Apicurio test environment

# Pipeline name and topics
pipeline.name=chunker-pipeline
pipeline.pipelineServiceName=chunker-service
pipeline.listen.topics=test-pipeline-input
pipeline.publish.topics=test-pipeline-output
pipeline.service.chunker-service.kafka-listen-topics=test-pipeline-input
pipeline.service.chunker-service.kafka-publish-topics=test-pipeline-output
pipeline.service.chunker-service.grpc-forward-to=null

# Chunker service configuration
pipeline.configs.chunker-pipeline.service.chunker-service.kafka-listen-topics=test-pipeline-input
pipeline.configs.chunker-pipeline.service.chunker-service.kafka-publish-topics=test-pipeline-output
pipeline.configs.chunker-pipeline.service.chunker-service.grpc-forward-to=null
pipeline.configs.chunker-pipeline.service.chunker-service.service-implementation=chunker-service

# Enable Apicurio Registry for Kafka serialization/deserialization
kafka.enabled=true

# Configure Kafka serializers/deserializers for Apicurio Registry
kafka.producers.default.value.serializer=io.apicurio.registry.serde.protobuf.ProtobufKafkaSerializer
kafka.consumers.default.value.deserializer=io.apicurio.registry.serde.protobuf.ProtobufKafkaDeserializer

# Configure Apicurio Registry URL and settings
kafka.producers.default.apicurio.registry.url=${REGISTRY_URL:http://localhost:8080/apis/registry/v3}
kafka.producers.default.apicurio.registry.auto-register=true
kafka.producers.default.apicurio.registry.artifact-resolver-strategy=io.apicurio.registry.serde.strategy.TopicIdStrategy
kafka.producers.default.apicurio.registry.artifact-group-id=default

kafka.consumers.default.apicurio.registry.url=${REGISTRY_URL:http://localhost:8080/apis/registry/v3}
kafka.consumers.default.apicurio.registry.auto-register=true
kafka.consumers.default.apicurio.registry.artifact-resolver-strategy=io.apicurio.registry.serde.strategy.TopicIdStrategy
kafka.consumers.default.apicurio.registry.artifact-group-id=default
kafka.consumers.default.apicurio.registry.specific-value-return-class=com.krickert.search.model.PipeStream

# Configure Kafka consumer group for the test
kafka.consumers.chunker-pipe-group.key.deserializer=org.apache.kafka.common.serialization.StringDeserializer
kafka.consumers.chunker-pipe-group.value.deserializer=io.apicurio.registry.serde.protobuf.ProtobufKafkaDeserializer
kafka.consumers.chunker-pipe-group.apicurio.registry.url=${REGISTRY_URL:http://localhost:8080/apis/registry/v3}
kafka.consumers.chunker-pipe-group.apicurio.registry.auto-register=true
kafka.consumers.chunker-pipe-group.apicurio.registry.artifact-resolver-strategy=io.apicurio.registry.serde.strategy.TopicIdStrategy
kafka.consumers.chunker-pipe-group.apicurio.registry.artifact-group-id=default
kafka.consumers.chunker-pipe-group.apicurio.registry.specific-value-return-class=com.krickert.search.model.PipeStream

# Executor configuration for dynamic Kafka consumer
micronaut.executors.dynamic-kafka-consumer-executor.type=fixed
micronaut.executors.dynamic-kafka-consumer-executor.n-threads=10
